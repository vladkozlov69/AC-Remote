#include <Arduino.h>
#include <IRremote.h>

#define PIN_BTN_ON 4
#define PIN_BTN_OFF 5

// NOTE : send pin = 3

IRsend irsend;

int khz = 38; // 38kHz carrier frequency
unsigned int payloadLen = 197;
int signalOn[] = {6148, -7340, 496, -1708, 568, -1612, 568, -1628, 604, -1624, 584, -1588, 584, -1616, 584, -1616, 548, -1656, 548, -576, 584, -544, 604, -520, 576, -552, 584, -544, 576, -556, 544, -600, 548, -576, 548, -1656, 548, -1652, 544, -1636, 608, -1592, 580, -1616, 608, -1592, 592, -1612, 576, -1624, 572, -552, 584, -544, 584, -544, 580, -548, 584, -564, 548, -576, 548, -580, 548, -576, 608, -1600, 544, -1652, 572, -1628, 548, -1636, 568, -1628, 580, -1620, 604, -1592, 588, -1616, 584, -544, 580, -544, 580, -552, 600, -528, 564, -580, 572, -552, 548, -580, 580, -544, 584, -1616, 612, -516, 584, -1620, 576, -548, 616, -512, 608, -520, 552, -1648, 576, -1620, 584, -548, 604, -1592, 620, -512, 572, -1624, 612, -1588, 584, -1616, 580, -544, 608, -524, 576, -1620, 580, -548, 608, -524, 548, -1648, 576, -1624, 612, -516, 608, -1596, 584, -1612, 580, -544, 608, -1592, 580, -1620, 588, -540, 616, -512, 580, -1620, 604, -524, 628, -500, 548, -596, 548, -1656, 572, -552, 548, -1656, 540, -584, 548, -1652, 544, -580, 548, -580, 548, -1652, 548, -576, 580, -1624, 548, -576, 576, -1628, 576, -548, 580, -1620, 580, -1620, 544, -7428, 544};
int signalOff[] = {6152, -7344, 512, -1684, 548, -1656, 548, -1632, 600, -1596, 604, -1596, 580, -1624, 628, -1568, 580, -1624, 536, -588, 576, -552, 580, -544, 584, -548, 600, -524, 584, -548, 548, -596, 496, -632, 568, -1632, 496, -1688, 564, -1632, 576, -1624, 620, -1576, 608, -1596, 576, -1628, 604, -1592, 572, -556, 604, -520, 584, -544, 608, -524, 576, -552, 564, -580, 496, -628, 544, -584, 580, -1620, 544, -1660, 492, -1688, 592, -1632, 552, -1624, 576, -1620, 580, -1620, 580, -1620, 604, -524, 580, -544, 608, -524, 604, -524, 568, -576, 496, -632, 572, -552, 580, -548, 604, -1596, 600, -1600, 572, -1628, 544, -580, 584, -544, 604, -520, 608, -1596, 604, -1596, 580, -544, 580, -548, 608, -520, 580, -1620, 608, -1592, 580, -1620, 580, -548, 604, -524, 580, -1620, 604, -520, 580, -552, 592, -1608, 600, -1596, 576, -552, 580, -1620, 604, -1596, 576, -552, 604, -1592, 584, -1616, 580, -548, 580, -548, 576, -1628, 576, -548, 576, -552, 592, -552, 516, -1688, 492, -628, 544, -1660, 548, -576, 544, -1660, 512, -612, 576, -548, 580, -1620, 580, -548, 580, -1620, 580, -544, 608, -1596, 580, -544, 608, -1596, 576, -1624, 580, -7384, 580};


void setup()
{
  for(unsigned int i = 0; i < payloadLen; i++)
  {
    signalOn[i] = abs(signalOn[i]);
    signalOff[i] = abs(signalOff[i]);
  }

  pinMode(PIN_BTN_ON, INPUT);
  pinMode(PIN_BTN_OFF, INPUT);
  pinMode(LED_BUILTIN, OUTPUT);
}

void sendPayload(const unsigned int buf[],  unsigned int len)
{
  digitalWrite(LED_BUILTIN, HIGH);
  irsend.sendRaw(buf, len, khz);
  digitalWrite(LED_BUILTIN, LOW);
}

void loop() 
{
  if (digitalRead(PIN_BTN_ON))
  {
    sendPayload((unsigned int)signalOn, payloadLen);
  }

  if (digitalRead(PIN_BTN_OFF))
  {
    sendPayload((unsigned int)signalOff, payloadLen);
  }

  delay(2000); 
}

